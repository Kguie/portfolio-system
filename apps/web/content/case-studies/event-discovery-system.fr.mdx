# Système de découverte d'événements

<div className="rounded-lg border border-cyan-300/30 bg-cyan-300/8 px-4 py-3 text-sm">
  <strong>TL;DR :</strong> Nous avons conçu une architecture modulaire de découverte d'événements avec ingestion normalisée, recherche rapide à facettes et télémétrie opérationnelle. La v1 privilégie la fiabilité et la latence requête.
</div>

## Problème

Les utilisateurs trouvaient difficilement des événements pertinents à cause de formats hétérogènes et d'une qualité de données variable selon les fournisseurs.

## Exigences

- Agréger les événements de plusieurs fournisseurs.
- Normaliser les métadonnées (ville, catégorie, lieu, horaire).
- Garantir une recherche rapide avec facettes.
- Rendre les flux d'ingestion et de requête observables en production.

## Architecture v1

```text
[Fournisseurs] -> [Workers d'ingestion] -> [Normalisation] -> [Postgres]
                                                   -> [Index de recherche]
[Mobile Expo] -> [API Go] -> [Recherche + Ranking] -> [Notifications FCM]
                                     |
                           [Métriques / Logs / Traces]
```

La v1 sépare ingestion et serving pour éviter qu'une instabilité fournisseur n'affecte directement la latence API.

## Compromis clés

- Normalisation stricte dès le départ : coût initial plus élevé, comportement recherche plus propre.
- Ranking côté serveur plutôt que tri client : clients plus simples, backend plus complexe.
- Personnalisation avancée reportée pour stabiliser la première mise en production.

## Observabilité

- Traces par requête sur API, ranking et appels recherche.
- Tableaux de bord latence/erreurs par route et fournisseur.
- Alertes de retard d'ingestion pour détecter les flux obsolètes.

## Feuille de route

- Ajouter des signaux de ranking orientés intention.
- Renforcer la déduplication des entrées quasi identiques.
- Introduire des expérimentations de pertinence avec évaluation offline.
- Étendre l'orchestration des notifications par cohortes utilisateurs.
